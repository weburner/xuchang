// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
// Licensed under the MIT license
// version: 3.0.5
(function(e){if(!Function.prototype.bind){Function.prototype.bind=function(e){var t=[].slice,n=t.call(arguments,1),r=this,i=function(){},s=function(){return r.apply(this instanceof i?this:e||{},n.concat(t.call(arguments)))};i.prototype=r.prototype;s.prototype=new i;return s}}if(typeof e.Code==="undefined"){e.Code={}}e.Code.Util={registerNamespace:function(){var t=arguments,n=null,r,i,s,o,u,a,f;for(r=0,a=t.length;r<a;r++){s=t[r];o=s.split(".");u=o[0];if(typeof e[u]==="undefined"){e[u]={}}n=e[u];for(i=1,f=o.length;i<f;++i){n[o[i]]=n[o[i]]||{};n=n[o[i]]}}},coalesce:function(){var e,t;for(e=0,t=arguments.length;e<t;e++){if(!this.isNothing(arguments[e])){return arguments[e]}}return null},extend:function(e,t,n){var r;if(this.isNothing(n)){n=true}if(e&&t&&this.isObject(t)){for(r in t){if(this.objectHasProperty(t,r)){if(n){e[r]=t[r]}else{if(typeof e[r]==="undefined"){e[r]=t[r]}}}}}},clone:function(e){var t={};this.extend(t,e);return t},isObject:function(e){return e instanceof Object},isFunction:function(e){return{}.toString.call(e)==="[object Function]"},isArray:function(e){return e instanceof Array},isLikeArray:function(e){return typeof e.length==="number"},isNumber:function(e){return typeof e==="number"},isString:function(e){return typeof e==="string"},isNothing:function(e){if(typeof e==="undefined"||e===null){return true}return false},swapArrayElements:function(e,t,n){var r=e[t];e[t]=e[n];e[n]=r},trim:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},toCamelCase:function(e){return e.replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-","")})},toDashedCase:function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})},arrayIndexOf:function(e,t,n){var r,i,s,o;s=-1;for(r=0,i=t.length;r<i;r++){o=t[r];if(!this.isNothing(n)){if(this.objectHasProperty(o,n)){if(o[n]===e){s=r;break}}}else{if(o===e){s=r;break}}}return s},objectHasProperty:function(e,t){if(e.hasOwnProperty){return e.hasOwnProperty(t)}else{return"undefined"!==typeof e[t]}}}})(window);(function(e,t){t.Browser={ua:null,version:null,safari:null,webkit:null,opera:null,msie:null,chrome:null,mozilla:null,android:null,blackberry:null,iPad:null,iPhone:null,iPod:null,iOS:null,is3dSupported:null,isCSSTransformSupported:null,isTouchSupported:null,isGestureSupported:null,_detect:function(){this.ua=e.navigator.userAgent;this.version=this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[];this.safari=/Safari/gi.test(e.navigator.appVersion);this.webkit=/webkit/i.test(this.ua);this.opera=/opera/i.test(this.ua);this.msie=/msie/i.test(this.ua)&&!this.opera;this.chrome=/Chrome/i.test(this.ua);this.firefox=/Firefox/i.test(this.ua);this.fennec=/Fennec/i.test(this.ua);this.mozilla=/mozilla/i.test(this.ua)&&!/(compatible|webkit)/.test(this.ua);this.android=/android/i.test(this.ua);this.blackberry=/blackberry/i.test(this.ua);this.iOS=/iphone|ipod|ipad/gi.test(e.navigator.platform);this.iOS7=this.iOS&&/OS 7_/i.test(navigator.userAgent);this.iPad=/ipad/gi.test(e.navigator.platform);this.iPhone=/iphone/gi.test(e.navigator.platform);this.iPod=/ipod/gi.test(e.navigator.platform);var n=document.createElement("div");this.is3dSupported=!t.isNothing(n.style.WebkitPerspective);this.isCSSTransformSupported=!t.isNothing(n.style.WebkitTransform)||!t.isNothing(n.style.MozTransform)||!t.isNothing(n.style.transformProperty);this.isTouchSupported=this.isEventSupported("touchstart");this.isGestureSupported=this.isEventSupported("gesturestart")},_eventTagNames:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},isEventSupported:function(e){if(this.iOS7&&e=="gesturestart"){return true}var n=document.createElement(this._eventTagNames[e]||"div"),r;e="on"+e;r=t.objectHasProperty(n,e);if(!r){n.setAttribute(e,"return;");r=typeof n[e]==="function"}n=null;return r},isLandscape:function(){return t.DOM.windowWidth()>t.DOM.windowHeight()}};t.Browser._detect()})(window,window.Code.Util);(function(e,t){t.extend(t,{Events:{add:function(e,t,n){this._checkHandlersProperty(e);if(t==="mousewheel"){t=this._normaliseMouseWheelType()}if(typeof e.__eventHandlers[t]==="undefined"){e.__eventHandlers[t]=[]}e.__eventHandlers[t].push(n);if(this._isBrowserObject(e)){e.addEventListener(t,n,false)}},remove:function(e,n,r){this._checkHandlersProperty(e);if(n==="mousewheel"){n=this._normaliseMouseWheelType()}if(e.__eventHandlers[n]instanceof Array){var i,s,o=e.__eventHandlers[n];if(t.isNothing(r)){if(this._isBrowserObject(e)){for(i=0,s=o.length;i<s;i++){e.removeEventListener(n,o[i],false)}}e.__eventHandlers[n]=[];return}for(i=0,s=o.length;i<s;i++){if(o[i]===r){o.splice(i,1);break}}if(this._isBrowserObject(e)){e.removeEventListener(n,r,false);return}}},fire:function(n,r){var i,s,o,u,a,f=Array.prototype.slice.call(arguments).splice(2),l;if(r==="mousewheel"){r=this._normaliseMouseWheelType()}if(this._isBrowserObject(n)){if(typeof r!=="string"){throw"type must be a string for DOM elements"}l=this._NATIVE_EVENTS[r];o=document.createEvent(l?"HTMLEvents":"UIEvents");o[l?"initEvent":"initUIEvent"](r,true,true,e,1);if(f.length<1){n.dispatchEvent(o);return}}this._checkHandlersProperty(n);if(typeof r==="string"){o={type:r}}else{o=r}if(!o.target){o.target=n}if(!o.type){throw new Error("Event object missing 'type' property.")}if(n.__eventHandlers[o.type]instanceof Array){u=n.__eventHandlers[o.type];f.unshift(o);for(i=0,s=u.length;i<s;i++){a=u[i];if(!t.isNothing(a)){a.apply(n,f)}}}},getMousePosition:function(e){var t={x:0,y:0};if(e.pageX){t.x=e.pageX}else if(e.clientX){t.x=e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)}if(e.pageY){t.y=e.pageY}else if(e.clientY){t.y=e.clientY+(document.documentElement.scrollTop||document.body.scrollTop)}return t},getTouchEvent:function(e){return e},getWheelDelta:function(e){var n=0;if(!t.isNothing(e.wheelDelta)){n=e.wheelDelta/120}else if(!t.isNothing(e.detail)){n=-e.detail/3}return n},domReady:function(e){document.addEventListener("DOMContentLoaded",e,false)},_checkHandlersProperty:function(e){if(t.isNothing(e.__eventHandlers)){t.extend(e,{__eventHandlers:{}})}},_isBrowserObject:function(t){if(t===e||t===e.document){return true}return this._isElement(t)||this._isNode(t)},_isElement:function(t){return typeof e.HTMLElement==="object"?t instanceof e.HTMLElement:typeof t==="object"&&t.nodeType===1&&typeof t.nodeName==="string"},_isNode:function(t){return typeof e.Node==="object"?t instanceof e.Node:typeof t==="object"&&typeof t.nodeType==="number"&&typeof t.nodeName==="string"},_normaliseMouseWheelType:function(){if(t.Browser.isEventSupported("mousewheel")){return"mousewheel"}return"DOMMouseScroll"},_NATIVE_EVENTS:{click:1,dblclick:1,mouseup:1,mousedown:1,contextmenu:1,mousewheel:1,DOMMouseScroll:1,mouseover:1,mouseout:1,mousemove:1,selectstart:1,selectend:1,keydown:1,keypress:1,keyup:1,orientationchange:1,touchstart:1,touchmove:1,touchend:1,touchcancel:1,gesturestart:1,gesturechange:1,gestureend:1,focus:1,blur:1,change:1,reset:1,select:1,submit:1,load:1,unload:1,beforeunload:1,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1}}})})(window,window.Code.Util);(function(e,t){t.extend(t,{DOM:{setData:function(e,n,r){if(t.isLikeArray(e)){var i,s;for(i=0,s=e.length;i<s;i++){t.DOM._setData(e[i],n,r)}}else{t.DOM._setData(e,n,r)}},_setData:function(e,n,r){t.DOM.setAttribute(e,"data-"+n,r)},getData:function(e,n,r){return t.DOM.getAttribute(e,"data-"+n,r)},removeData:function(e,n){if(t.isLikeArray(e)){var r,i;for(r=0,i=e.length;r<i;r++){t.DOM._removeData(e[r],n)}}else{t.DOM._removeData(e,n)}},_removeData:function(e,n){t.DOM.removeAttribute(e,"data-"+n)},isChildOf:function(e,t){if(t===e){return false}while(e&&e!==t){e=e.parentNode}return e===t},find:function(n,r){if(t.isNothing(r)){r=e.document}var i=r.querySelectorAll(n),s=[],o,u;for(o=0,u=i.length;o<u;o++){s.push(i[o])}return s},createElement:function(e,n,r){var i,s=document.createElement(e);for(i in n){if(t.objectHasProperty(n,i)){s.setAttribute(i,n[i])}}s.innerHTML=r||"";return s},appendChild:function(e,t){t.appendChild(e)},insertBefore:function(e,t,n){n.insertBefore(e,t)},appendText:function(e,n){t.DOM.appendChild(document.createTextNode(e),n)},appendToBody:function(e){this.appendChild(e,document.body)},removeChild:function(e,t){t.removeChild(e)},removeChildren:function(e){if(e.hasChildNodes()){while(e.childNodes.length>=1){e.removeChild(e.childNodes[e.childNodes.length-1])}}},hasAttribute:function(e,n){return!t.isNothing(e.getAttribute(n))},getAttribute:function(e,n,r){var i=e.getAttribute(n);if(t.isNothing(i)&&!t.isNothing(r)){i=r}return i},setAttribute:function(e,n,r){if(t.isLikeArray(e)){var i,s;for(i=0,s=e.length;i<s;i++){t.DOM._setAttribute(e[i],n,r)}}else{t.DOM._setAttribute(e,n,r)}},_setAttribute:function(e,t,n){e.setAttribute(t,n)},removeAttribute:function(e,n){if(t.isLikeArray(e)){var r,i;for(r=0,i=e.length;r<i;r++){t.DOM._removeAttribute(e[r],n)}}else{t.DOM._removeAttribute(e,n)}},_removeAttribute:function(e,t){if(this.hasAttribute(e,t)){e.removeAttribute(t)}},addClass:function(e,n){if(t.isLikeArray(e)){var r,i;for(r=0,i=e.length;r<i;r++){t.DOM._addClass(e[r],n)}}else{t.DOM._addClass(e,n)}},_addClass:function(e,n){var r=t.DOM.getAttribute(e,"class",""),i=new RegExp("(?:^|\\s+)"+n+"(?:\\s+|$)");if(!i.test(r)){if(r!==""){r=r+" "}r=r+n;t.DOM.setAttribute(e,"class",r)}},removeClass:function(e,n){if(t.isLikeArray(e)){var r,i;for(r=0,i=e.length;r<i;r++){t.DOM._removeClass(e[r],n)}}else{t.DOM._removeClass(e,n)}},_removeClass:function(e,n){var r=t.DOM.getAttribute(e,"class",""),i=t.trim(r).split(" "),s="",o,u;for(o=0,u=i.length;o<u;o++){if(i[o]!==n){if(s!==""){s+=" "}s+=i[o]}}if(s===""){t.DOM.removeAttribute(e,"class")}else{t.DOM.setAttribute(e,"class",s)}},hasClass:function(e,n){var r=new RegExp("(?:^|\\s+)"+n+"(?:\\s+|$)");return r.test(t.DOM.getAttribute(e,"class",""))},setStyle:function(e,n,r){if(t.isLikeArray(e)){var i,s;for(i=0,s=e.length;i<s;i++){t.DOM._setStyle(e[i],n,r)}}else{t.DOM._setStyle(e,n,r)}},_setStyle:function(e,n,r){var i,s;if(t.isObject(n)){for(i in n){if(t.objectHasProperty(n,i)){if(i==="width"){t.DOM.width(e,n[i])}else if(i==="height"){t.DOM.height(e,n[i])}else{e.style[i]=n[i]}}}}else{e.style[n]=r}},getStyle:function(t,n){var r=e.getComputedStyle(t,"").getPropertyValue(n);if(r===""){r=t.style[n]}return r},hide:function(e){if(t.isLikeArray(e)){var n,r;for(n=0,r=e.length;n<r;n++){t.DOM._hide(e[n])}}else{t.DOM._hide(e)}},_hide:function(e){t.DOM.setData(e,"ccl-disp",t.DOM.getStyle(e,"display"));t.DOM.setStyle(e,"display","none")},show:function(e){if(t.isLikeArray(e)){var n,r;for(n=0,r=e.length;n<r;n++){t.DOM._show(e[n])}}else{t.DOM._show(e)}},_show:function(e){if(t.DOM.getStyle(e,"display")==="none"){var n=t.DOM.getData(e,"ccl-disp","block");if(n==="none"||n===""){n="block"}t.DOM.setStyle(e,"display",n)}},width:function(e,n){if(!t.isNothing(n)){if(t.isNumber(n)){n=n+"px"}e.style.width=n}return this._getDimension(e,"width")},outerWidth:function(e){var n=t.DOM.width(e);n+=parseInt(t.DOM.getStyle(e,"padding-left"),10)+parseInt(t.DOM.getStyle(e,"padding-right"),10);n+=parseInt(t.DOM.getStyle(e,"margin-left"),10)+parseInt(t.DOM.getStyle(e,"margin-right"),10);n+=parseInt(t.DOM.getStyle(e,"border-left-width"),10)+parseInt(t.DOM.getStyle(e,"border-right-width"),10);return n},height:function(e,n){if(!t.isNothing(n)){if(t.isNumber(n)){n=n+"px"}e.style.height=n}return this._getDimension(e,"height")},_getDimension:function(t,n){var r=e.parseInt(e.getComputedStyle(t,"").getPropertyValue(n)),i;if(isNaN(r)){i={display:t.style.display,left:t.style.left};t.style.display="block";t.style.left="-1000000px";r=e.parseInt(e.getComputedStyle(t,"").getPropertyValue(n));t.style.display=i.display;t.style.left=i.left}return r},outerHeight:function(e){var n=t.DOM.height(e);n+=parseInt(t.DOM.getStyle(e,"padding-top"),10)+parseInt(t.DOM.getStyle(e,"padding-bottom"),10);n+=parseInt(t.DOM.getStyle(e,"margin-top"),10)+parseInt(t.DOM.getStyle(e,"margin-bottom"),10);n+=parseInt(t.DOM.getStyle(e,"border-top-width"),10)+parseInt(t.DOM.getStyle(e,"border-bottom-width"),10);return n},documentWidth:function(){return t.DOM.width(document.documentElement)},documentHeight:function(){return t.DOM.height(document.documentElement)},documentOuterWidth:function(){return t.DOM.width(document.documentElement)},documentOuterHeight:function(){return t.DOM.outerHeight(document.documentElement)},bodyWidth:function(){return t.DOM.width(document.body)},bodyHeight:function(){return t.DOM.height(document.body)},bodyOuterWidth:function(){return t.DOM.outerWidth(document.body)},bodyOuterHeight:function(){return t.DOM.outerHeight(document.body)},windowWidth:function(){return e.innerWidth},windowHeight:function(){return e.innerHeight},windowScrollLeft:function(){return e.pageXOffset},windowScrollTop:function(){return e.pageYOffset}}})})(window,window.Code.Util);(function(e,t){t.extend(t,{Animation:{_applyTransitionDelay:50,_transitionEndLabel:e.document.documentElement.style.webkitTransition!==undefined?"webkitTransitionEnd":"transitionend",_transitionEndHandler:null,_transitionPrefix:e.document.documentElement.style.webkitTransition!==undefined?"webkitTransition":e.document.documentElement.style.MozTransition!==undefined?"MozTransition":"transition",_transformLabel:e.document.documentElement.style.webkitTransform!==undefined?"webkitTransform":e.document.documentElement.style.MozTransition!==undefined?"MozTransform":"transform",_getTransitionEndHandler:function(){if(t.isNothing(this._transitionEndHandler)){this._transitionEndHandler=this._onTransitionEnd.bind(this)}return this._transitionEndHandler},stop:function(n){if(t.Browser.isCSSTransformSupported){var r=n.style[this._transitionPrefix+"Property"],i=r!==""?"ccl"+r+"callback":"cclallcallback",s={};t.Events.remove(n,this._transitionEndLabel,this._getTransitionEndHandler());if(t.isNothing(n.callbackLabel)){delete n.callbackLabel}s[this._transitionPrefix+"Property"]="";s[this._transitionPrefix+"Duration"]="";s[this._transitionPrefix+"TimingFunction"]="";s[this._transitionPrefix+"Delay"]="";s[this._transformLabel]="";t.DOM.setStyle(n,s)}else if(!t.isNothing(e.jQuery)){e.jQuery(n).stop(true,true)}},fadeIn:function(n,r,i,s,o){o=t.coalesce(o,1);if(o<=0){o=1}if(r<=0){t.DOM.setStyle(n,"opacity",o);if(!t.isNothing(i)){i(n);return}}var u=t.DOM.getStyle(n,"opacity");if(u>=1){t.DOM.setStyle(n,"opacity",0)}if(t.Browser.isCSSTransformSupported){this._applyTransition(n,"opacity",o,r,i,s)}else if(!t.isNothing(e.jQuery)){e.jQuery(n).fadeTo(r,o,i)}},fadeTo:function(e,t,n,r,i){this.fadeIn(e,n,r,i,t)},fadeOut:function(n,r,i,s){if(r<=0){t.DOM.setStyle(n,"opacity",0);if(!t.isNothing(i)){i(n);return}}if(t.Browser.isCSSTransformSupported){this._applyTransition(n,"opacity",0,r,i,s)}else{e.jQuery(n).fadeTo(r,0,i)}},slideBy:function(n,r,i,s,o,u){var a={};r=t.coalesce(r,0);i=t.coalesce(i,0);u=t.coalesce(u,"ease-out");a[this._transitionPrefix+"Property"]="all";a[this._transitionPrefix+"Delay"]="0";if(s===0){a[this._transitionPrefix+"Duration"]="";a[this._transitionPrefix+"TimingFunction"]=""}else{a[this._transitionPrefix+"Duration"]=s+"ms";a[this._transitionPrefix+"TimingFunction"]=t.coalesce(u,"ease-out");t.Events.add(n,this._transitionEndLabel,this._getTransitionEndHandler())}a[this._transformLabel]=t.Browser.is3dSupported?"translate3d("+r+"px, "+i+"px, 0px)":"translate("+r+"px, "+i+"px)";if(!t.isNothing(o)){n.cclallcallback=o}t.DOM.setStyle(n,a);if(s===0){e.setTimeout(function(){this._leaveTransforms(n)}.bind(this),this._applyTransitionDelay)}},resetTranslate:function(e){var n={};n[this._transformLabel]=n[this._transformLabel]=t.Browser.is3dSupported?"translate3d(0px, 0px, 0px)":"translate(0px, 0px)";t.DOM.setStyle(e,n)},_applyTransition:function(n,r,i,s,o,u){var a={};u=t.coalesce(u,"ease-in");a[this._transitionPrefix+"Property"]=r;a[this._transitionPrefix+"Duration"]=s+"ms";a[this._transitionPrefix+"TimingFunction"]=u;a[this._transitionPrefix+"Delay"]="0";t.Events.add(n,this._transitionEndLabel,this._getTransitionEndHandler());t.DOM.setStyle(n,a);if(!t.isNothing(o)){n["ccl"+r+"callback"]=o}e.setTimeout(function(){t.DOM.setStyle(n,r,i)},this._applyTransitionDelay)},_onTransitionEnd:function(e){t.Events.remove(e.currentTarget,this._transitionEndLabel,this._getTransitionEndHandler());this._leaveTransforms(e.currentTarget)},_leaveTransforms:function(n){var r=n.style[this._transitionPrefix+"Property"],i=r!==""?"ccl"+r+"callback":"cclallcallback",s,o=t.coalesce(n.style.webkitTransform,n.style.MozTransform,n.style.transform),u,a,f=e.parseInt(t.DOM.getStyle(n,"left"),0),l=e.parseInt(t.DOM.getStyle(n,"top"),0),c,h,p={};if(o!==""){if(t.Browser.is3dSupported){u=o.match(/translate3d\((.*?)\)/)}else{u=o.match(/translate\((.*?)\)/)}if(!t.isNothing(u)){a=u[1].split(", ");c=e.parseInt(a[0],0);h=e.parseInt(a[1],0)}}p[this._transitionPrefix+"Property"]="";p[this._transitionPrefix+"Duration"]="";p[this._transitionPrefix+"TimingFunction"]="";p[this._transitionPrefix+"Delay"]="";t.DOM.setStyle(n,p);e.setTimeout(function(){if(!t.isNothing(a)){p={};p[this._transformLabel]="";p.left=f+c+"px";p.top=l+h+"px";t.DOM.setStyle(n,p)}if(!t.isNothing(n[i])){s=n[i];delete n[i];s(n)}}.bind(this),this._applyTransitionDelay)}}})})(window,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.Util.TouchElement");n.TouchElement.EventTypes={onTouch:"CodeUtilTouchElementOnTouch"};n.TouchElement.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",tap:"tap",doubleTap:"doubleTap",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",gestureStart:"gestureStart",gestureChange:"gestureChange",gestureEnd:"gestureEnd"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.Util.TouchElement");n.TouchElement.TouchElementClass=t({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,doubleTapTimeout:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,mouseDownHandler:null,mouseMoveHandler:null,mouseUpHandler:null,mouseOutHandler:null,gestureStartHandler:null,gestureChangeHandler:null,gestureEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,doubleTapSpeed:null,dispose:function(){var e;this.removeEventHandlers();for(e in this){if(n.objectHasProperty(this,e)){this[e]=null}}},initialize:function(e,t){this.el=e;this.captureSettings={swipe:false,move:false,gesture:false,doubleTap:false,preventDefaultTouchEvents:true};n.extend(this.captureSettings,t);this.swipeThreshold=50;this.swipeTimeThreshold=250;this.doubleTapSpeed=250;this.touchStartPoint={x:0,y:0};this.touchEndPoint={x:0,y:0}},addEventHandlers:function(){if(n.isNothing(this.touchStartHandler)){this.touchStartHandler=this.onTouchStart.bind(this);this.touchMoveHandler=this.onTouchMove.bind(this);this.touchEndHandler=this.onTouchEnd.bind(this);this.mouseDownHandler=this.onMouseDown.bind(this);this.mouseMoveHandler=this.onMouseMove.bind(this);this.mouseUpHandler=this.onMouseUp.bind(this);this.mouseOutHandler=this.onMouseOut.bind(this);this.gestureStartHandler=this.onGestureStart.bind(this);this.gestureChangeHandler=this.onGestureChange.bind(this);this.gestureEndHandler=this.onGestureEnd.bind(this)}n.Events.add(this.el,"touchstart",this.touchStartHandler);if(this.captureSettings.move){n.Events.add(this.el,"touchmove",this.touchMoveHandler)}n.Events.add(this.el,"touchend",this.touchEndHandler);n.Events.add(this.el,"mousedown",this.mouseDownHandler);if(n.Browser.isGestureSupported&&this.captureSettings.gesture){n.Events.add(this.el,"gesturestart",this.gestureStartHandler);n.Events.add(this.el,"gesturechange",this.gestureChangeHandler);n.Events.add(this.el,"gestureend",this.gestureEndHandler)}},removeEventHandlers:function(){n.Events.remove(this.el,"touchstart",this.touchStartHandler);if(this.captureSettings.move){n.Events.remove(this.el,"touchmove",this.touchMoveHandler)}n.Events.remove(this.el,"touchend",this.touchEndHandler);n.Events.remove(this.el,"mousedown",this.mouseDownHandler);if(n.Browser.isGestureSupported&&this.captureSettings.gesture){var t=this.el;if(n.Browser.iOS7&&t==e){t=document}n.Events.remove(this.el,"gesturestart",this.gestureStartHandler);n.Events.remove(this.el,"gesturechange",this.gestureChangeHandler);n.Events.remove(this.el,"gestureend",this.gestureEndHandler)}},getTouchPoint:function(e){return{x:e[0].pageX,y:e[0].pageY}},fireTouchEvent:function(t){var r,i=0,s=0,o=0,u,a,f;i=this.touchEndPoint.x-this.touchStartPoint.x;s=this.touchEndPoint.y-this.touchStartPoint.y;o=Math.sqrt(i*i+s*s);if(this.captureSettings.swipe){a=new Date;f=a-this.touchStartTime;if(f<=this.swipeTimeThreshold){if(e.Math.abs(i)>=this.swipeThreshold){n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:i<0?n.TouchElement.ActionTypes.swipeLeft:n.TouchElement.ActionTypes.swipeRight,targetEl:t.target,currentTargetEl:t.currentTarget});return}if(e.Math.abs(s)>=this.swipeThreshold){n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:s<0?n.TouchElement.ActionTypes.swipeUp:n.TouchElement.ActionTypes.swipeDown,targetEl:t.target,currentTargetEl:t.currentTarget});return}}}if(o>1){n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchMoveEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget});return}if(!this.captureSettings.doubleTap){n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:n.TouchElement.ActionTypes.tap,targetEl:t.target,currentTargetEl:t.currentTarget});return}if(n.isNothing(this.doubleTapTimeout)){this.doubleTapTimeout=e.setTimeout(function(){this.doubleTapTimeout=null;n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:n.TouchElement.ActionTypes.tap,targetEl:t.target,currentTargetEl:t.currentTarget})}.bind(this),this.doubleTapSpeed);return}else{e.clearTimeout(this.doubleTapTimeout);this.doubleTapTimeout=null;n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:n.TouchElement.ActionTypes.doubleTap,targetEl:t.target,currentTargetEl:t.currentTarget})}},onTouchStart:function(e){if(this.captureSettings.preventDefaultTouchEvents){e.preventDefault()}n.Events.remove(this.el,"mousedown",this.mouseDownHandler);var t=n.Events.getTouchEvent(e),r=t.touches;if(r.length>1&&this.captureSettings.gesture){this.isGesture=true;return}this.touchStartTime=new Date;this.isGesture=false;this.touchStartPoint=this.getTouchPoint(r);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:e.target,currentTargetEl:e.currentTarget})},onTouchMove:function(e){if(this.captureSettings.preventDefaultTouchEvents){e.preventDefault()}if(this.isGesture&&this.captureSettings.gesture){return}var t=n.Events.getTouchEvent(e),r=t.touches;n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchMove,point:this.getTouchPoint(r),targetEl:e.target,currentTargetEl:e.currentTarget})},onTouchEnd:function(e){if(this.isGesture&&this.captureSettings.gesture){return}if(this.captureSettings.preventDefaultTouchEvents){e.preventDefault()}var t=n.Events.getTouchEvent(e),r=!n.isNothing(t.changedTouches)?t.changedTouches:t.touches;this.touchEndPoint=this.getTouchPoint(r);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:e.target,currentTargetEl:e.currentTarget});this.fireTouchEvent(e)},onMouseDown:function(e){e.preventDefault();n.Events.remove(this.el,"touchstart",this.mouseDownHandler);n.Events.remove(this.el,"touchmove",this.touchMoveHandler);n.Events.remove(this.el,"touchend",this.touchEndHandler);if(this.captureSettings.move){n.Events.add(this.el,"mousemove",this.mouseMoveHandler)}n.Events.add(this.el,"mouseup",this.mouseUpHandler);n.Events.add(this.el,"mouseout",this.mouseOutHandler);this.touchStartTime=new Date;this.isGesture=false;this.touchStartPoint=n.Events.getMousePosition(e);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:e.target,currentTargetEl:e.currentTarget})},onMouseMove:function(e){e.preventDefault();n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchMove,point:n.Events.getMousePosition(e),targetEl:e.target,currentTargetEl:e.currentTarget})},onMouseUp:function(e){e.preventDefault();if(this.captureSettings.move){n.Events.remove(this.el,"mousemove",this.mouseMoveHandler)}n.Events.remove(this.el,"mouseup",this.mouseUpHandler);n.Events.remove(this.el,"mouseout",this.mouseOutHandler);this.touchEndPoint=n.Events.getMousePosition(e);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:e.target,currentTargetEl:e.currentTarget});this.fireTouchEvent(e)},onMouseOut:function(e){var t=e.relatedTarget;if(this.el===t||n.DOM.isChildOf(t,this.el)){return}e.preventDefault();if(this.captureSettings.move){n.Events.remove(this.el,"mousemove",this.mouseMoveHandler)}n.Events.remove(this.el,"mouseup",this.mouseUpHandler);n.Events.remove(this.el,"mouseout",this.mouseOutHandler);this.touchEndPoint=n.Events.getMousePosition(e);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:e.target,currentTargetEl:e.currentTarget});this.fireTouchEvent(e)},onGestureStart:function(e){e.preventDefault();var t=n.Events.getTouchEvent(e);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.gestureStart,scale:t.scale,rotation:t.rotation,targetEl:e.target,currentTargetEl:e.currentTarget})},onGestureChange:function(e){e.preventDefault();var t=n.Events.getTouchEvent(e);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.gestureChange,scale:t.scale,rotation:t.rotation,targetEl:e.target,currentTargetEl:e.currentTarget})},onGestureEnd:function(e){e.preventDefault();var t=n.Events.getTouchEvent(e);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.gestureEnd,scale:t.scale,rotation:t.rotation,targetEl:e.target,currentTargetEl:e.currentTarget})}})})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Image");var r=e.Code.PhotoSwipe;r.Image.EventTypes={onLoad:"onLoad",onError:"onError"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Image");var r=e.Code.PhotoSwipe;r.Image.ImageClass=t({refObj:null,imageEl:null,src:null,caption:null,metaData:null,imageLoadHandler:null,imageErrorHandler:null,dispose:function(){var e,t;this.shrinkImage();for(e in this){if(n.objectHasProperty(this,e)){this[e]=null}}},initialize:function(t,n,r,i){this.refObj=t;this.originalSrc=n;this.src=n;this.caption=r;this.metaData=i;this.imageEl=new e.Image;this.imageLoadHandler=this.onImageLoad.bind(this);this.imageErrorHandler=this.onImageError.bind(this)},load:function(){this.imageEl.originalSrc=n.coalesce(this.imageEl.originalSrc,"");if(this.imageEl.originalSrc===this.src){if(this.imageEl.isError){n.Events.fire(this,{type:r.Image.EventTypes.onError,target:this})}else{n.Events.fire(this,{type:r.Image.EventTypes.onLoad,target:this})}return}this.imageEl.isError=false;this.imageEl.isLoading=true;this.imageEl.naturalWidth=null;this.imageEl.naturalHeight=null;this.imageEl.isLandscape=false;this.imageEl.onload=this.imageLoadHandler;this.imageEl.onerror=this.imageErrorHandler;this.imageEl.onabort=this.imageErrorHandler;this.imageEl.originalSrc=this.src;this.imageEl.src=this.src},shrinkImage:function(){if(n.isNothing(this.imageEl)){return}if(this.imageEl.src.indexOf(this.src)>-1){this.imageEl.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";if(!n.isNothing(this.imageEl.parentNode)){n.DOM.removeChild(this.imageEl,this.imageEl.parentNode)}}},onImageLoad:function(e){this.imageEl.onload=null;this.imageEl.naturalWidth=n.coalesce(this.imageEl.naturalWidth,this.imageEl.width);this.imageEl.naturalHeight=n.coalesce(this.imageEl.naturalHeight,this.imageEl.height);this.imageEl.isLandscape=this.imageEl.naturalWidth>this.imageEl.naturalHeight;this.imageEl.isLoading=false;n.Events.fire(this,{type:r.Image.EventTypes.onLoad,target:this})},onImageError:function(e){this.imageEl.onload=null;this.imageEl.onerror=null;this.imageEl.onabort=null;this.imageEl.isLoading=false;this.imageEl.isError=true;n.Events.fire(this,{type:r.Image.EventTypes.onError,target:this})}})})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Cache");var r=e.Code.PhotoSwipe;r.Cache.Mode={normal:"normal",aggressive:"aggressive"};r.Cache.Functions={getImageSource:function(e){return e.href},getImageCaption:function(e){if(e.nodeName==="IMG"){return n.DOM.getAttribute(e,"alt")}var t,r,i;for(t=0,r=e.childNodes.length;t<r;t++){i=e.childNodes[t];if(e.childNodes[t].nodeName==="IMG"){return n.DOM.getAttribute(i,"alt")}}},getImageMetaData:function(e){return{}}}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Cache");var r=e.Code.PhotoSwipe;r.Cache.CacheClass=t({images:null,settings:null,dispose:function(){var e,t,r;if(!n.isNothing(this.images)){for(t=0,r=this.images.length;t<r;t++){this.images[t].dispose()}this.images.length=0}for(e in this){if(n.objectHasProperty(this,e)){this[e]=null}}},initialize:function(e,t){var n,i,s,o,u,a,f;this.settings=t;this.images=[];for(n=0,i=e.length;n<i;n++){o=e[n];u=this.settings.getImageSource(o);a=this.settings.getImageCaption(o);f=this.settings.getImageMetaData(o);this.images.push(new r.Image.ImageClass(o,u,a,f))}},getImages:function(e){var t,i,s=[],o;for(t=0,i=e.length;t<i;t++){o=this.images[e[t]];if(this.settings.cacheMode===r.Cache.Mode.aggressive){o.cacheDoNotShrink=true}s.push(o)}if(this.settings.cacheMode===r.Cache.Mode.aggressive){for(t=0,i=this.images.length;t<i;t++){o=this.images[t];if(!n.objectHasProperty(o,"cacheDoNotShrink")){o.shrinkImage()}else{delete o.cacheDoNotShrink}}}return s}})})(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Image);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var r=e.Code.PhotoSwipe;r.DocumentOverlay.CssClasses={documentOverlay:"ps-document-overlay"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var r=e.Code.PhotoSwipe;r.DocumentOverlay.DocumentOverlayClass=t({el:null,settings:null,initialBodyHeight:null,dispose:function(){var e;n.Animation.stop(this.el);n.DOM.removeChild(this.el,this.el.parentNode);for(e in this){if(n.objectHasProperty(this,e)){this[e]=null}}},initialize:function(t){this.settings=t;this.el=n.DOM.createElement("div",{"class":r.DocumentOverlay.CssClasses.documentOverlay},"");n.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,zIndex:this.settings.zIndex});n.DOM.hide(this.el);if(this.settings.target===e){n.DOM.appendToBody(this.el)}else{n.DOM.appendChild(this.el,this.settings.target)}n.Animation.resetTranslate(this.el);this.initialBodyHeight=n.DOM.bodyOuterHeight()},resetPosition:function(){var t,r,i;if(this.settings.target===e){t=n.DOM.windowWidth();r=n.DOM.bodyOuterHeight()*2;i=this.settings.jQueryMobile?n.DOM.windowScrollTop()+"px":"0px";if(r<1){r=this.initialBodyHeight}if(n.DOM.windowHeight()>r){r=n.DOM.windowHeight()}}else{t=n.DOM.width(this.settings.target);r=n.DOM.height(this.settings.target);i="0px"}n.DOM.setStyle(this.el,{width:t,height:r,top:i})},fadeIn:function(e,t){this.resetPosition();n.DOM.setStyle(this.el,"opacity",0);n.DOM.show(this.el);n.Animation.fadeIn(this.el,e,t)}})})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Carousel");var r=e.Code.PhotoSwipe;r.Carousel.EventTypes={onSlideByEnd:"PhotoSwipeCarouselOnSlideByEnd",onSlideshowStart:"PhotoSwipeCarouselOnSlideshowStart",onSlideshowStop:"PhotoSwipeCarouselOnSlideshowStop"};r.Carousel.CssClasses={carousel:"ps-carousel",content:"ps-carousel-content",item:"ps-carousel-item",itemLoading:"ps-carousel-item-loading",itemError:"ps-carousel-item-error"};r.Carousel.SlideByAction={previous:"previous",current:"current",next:"next"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Carousel");var r=e.Code.PhotoSwipe;r.Carousel.CarouselClass=t({el:null,contentEl:null,settings:null,cache:null,slideByEndHandler:null,currentCacheIndex:null,isSliding:null,isSlideshowActive:null,lastSlideByAction:null,touchStartPoint:null,touchStartPosition:null,imageLoadHandler:null,imageErrorHandler:null,slideshowTimeout:null,dispose:function(){var e,t,i;for(t=0,i=this.cache.images.length;t<i;t++){n.Events.remove(this.cache.images[t],r.Image.EventTypes.onLoad,this.imageLoadHandler);n.Events.remove(this.cache.images[t],r.Image.EventTypes.onError,this.imageErrorHandler)}this.stopSlideshow();n.Animation.stop(this.el);n.DOM.removeChild(this.el,this.el.parentNode);for(e in this){if(n.objectHasProperty(this,e)){this[e]=null}}},initialize:function(t,i){var s,o,u;this.cache=t;this.settings=i;this.slideByEndHandler=this.onSlideByEnd.bind(this);this.imageLoadHandler=this.onImageLoad.bind(this);this.imageErrorHandler=this.onImageError.bind(this);this.currentCacheIndex=0;this.isSliding=false;this.isSlideshowActive=false;if(this.cache.images.length<3){this.settings.loop=false}this.el=n.DOM.createElement("div",{"class":r.Carousel.CssClasses.carousel},"");n.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex});n.DOM.hide(this.el);this.contentEl=n.DOM.createElement("div",{"class":r.Carousel.CssClasses.content},"");n.DOM.setStyle(this.contentEl,{display:"block",position:"absolute",left:0,top:0});n.DOM.appendChild(this.contentEl,this.el);o=t.images.length<3?t.images.length:3;for(s=0;s<o;s++){u=n.DOM.createElement("div",{"class":r.Carousel.CssClasses.item+" "+r.Carousel.CssClasses.item+"-"+s},"");n.DOM.setAttribute(u,"style","float: left;");n.DOM.setStyle(u,{display:"block",position:"relative",left:0,top:0,overflow:"hidden"});if(this.settings.margin>0){n.DOM.setStyle(u,{marginRight:this.settings.margin+"px"})}n.DOM.appendChild(u,this.contentEl)}if(this.settings.target===e){n.DOM.appendToBody(this.el)}else{n.DOM.appendChild(this.el,this.settings.target)}},resetPosition:function(){var t,i,s,o,u,a,f,l,c,h;if(this.settings.target===e){t=n.DOM.windowWidth();i=n.DOM.windowHeight();s=n.DOM.windowScrollTop()+"px"}else{t=n.DOM.width(this.settings.target);i=n.DOM.height(this.settings.target);s="0px"}o=this.settings.margin>0?t+this.settings.margin:t;u=n.DOM.find("."+r.Carousel.CssClasses.item,this.contentEl);a=o*u.length;n.DOM.setStyle(this.el,{top:s,width:t,height:i});n.DOM.setStyle(this.contentEl,{width:a,height:i});for(f=0,l=u.length;f<l;f++){c=u[f];n.DOM.setStyle(c,{width:t,height:i});h=n.DOM.find("img",c)[0];if(!n.isNothing(h)){this.resetImagePosition(h)}}this.setContentLeftPosition()},resetImagePosition:function(e){if(n.isNothing(e)){return}var t=n.DOM.getAttribute(e,"src"),r,i,s,o,u,a=n.DOM.width(this.el),f=n.DOM.height(this.el);if(this.settings.imageScaleMethod==="fitNoUpscale"){i=e.naturalWidth;s=e.naturalHeight;if(i>a){r=a/i;i=Math.round(i*r);s=Math.round(s*r)}if(s>f){r=f/s;s=Math.round(s*r);i=Math.round(i*r)}}else{if(e.isLandscape){r=a/e.naturalWidth}else{r=f/e.naturalHeight}i=Math.round(e.naturalWidth*r);s=Math.round(e.naturalHeight*r);if(this.settings.imageScaleMethod==="zoom"){r=1;if(s<f){r=f/s}else if(i<a){r=a/i}if(r!==1){i=Math.round(i*r);s=Math.round(s*r)}}else if(this.settings.imageScaleMethod==="fit"){r=1;if(i>a){r=a/i}else if(s>f){r=f/s}if(r!==1){i=Math.round(i*r);s=Math.round(s*r)}}}o=Math.round((f-s)/2)+"px";u=Math.round((a-i)/2)+"px";n.DOM.setStyle(e,{position:"absolute",width:i,height:s,top:o,left:u,display:"block"})},setContentLeftPosition:function(){var t,r,i;if(this.settings.target===e){t=n.DOM.windowWidth()}else{t=n.DOM.width(this.settings.target)}r=this.getItemEls();i=0;if(this.settings.loop){i=(t+this.settings.margin)*-1}else{if(this.currentCacheIndex===this.cache.images.length-1){i=(r.length-1)*(t+this.settings.margin)*-1}else if(this.currentCacheIndex>0){i=(t+this.settings.margin)*-1}}n.DOM.setStyle(this.contentEl,{left:i+"px"})},show:function(e){this.currentCacheIndex=e;this.resetPosition();this.setImages(false);n.DOM.show(this.el);n.Animation.resetTranslate(this.contentEl);var t=this.getItemEls(),i,s;for(i=0,s=t.length;i<s;i++){n.Animation.resetTranslate(t[i])}n.Events.fire(this,{type:r.Carousel.EventTypes.onSlideByEnd,target:this,action:r.Carousel.SlideByAction.current,cacheIndex:this.currentCacheIndex})},setImages:function(e){var t,n=this.getItemEls(),r=this.currentCacheIndex+1,i=this.currentCacheIndex-1;if(this.settings.loop){if(r>this.cache.images.length-1){r=0}if(i<0){i=this.cache.images.length-1}t=this.cache.getImages([i,this.currentCacheIndex,r]);if(!e){this.addCacheImageToItemEl(t[1],n[1])}this.addCacheImageToItemEl(t[2],n[2]);this.addCacheImageToItemEl(t[0],n[0])}else{if(n.length===1){if(!e){t=this.cache.getImages([this.currentCacheIndex]);this.addCacheImageToItemEl(t[0],n[0])}}else if(n.length===2){if(this.currentCacheIndex===0){t=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1]);if(!e){this.addCacheImageToItemEl(t[0],n[0])}this.addCacheImageToItemEl(t[1],n[1])}else{t=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex]);if(!e){this.addCacheImageToItemEl(t[1],n[1])}this.addCacheImageToItemEl(t[0],n[0])}}else{if(this.currentCacheIndex===0){t=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1,this.currentCacheIndex+2]);if(!e){this.addCacheImageToItemEl(t[0],n[0])}this.addCacheImageToItemEl(t[1],n[1]);this.addCacheImageToItemEl(t[2],n[2])}else if(this.currentCacheIndex===this.cache.images.length-1){t=this.cache.getImages([this.currentCacheIndex-2,this.currentCacheIndex-1,this.currentCacheIndex]);if(!e){this.addCacheImageToItemEl(t[2],n[2])}this.addCacheImageToItemEl(t[1],n[1]);this.addCacheImageToItemEl(t[0],n[0])}else{t=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex,this.currentCacheIndex+1]);if(!e){this.addCacheImageToItemEl(t[1],n[1])}this.addCacheImageToItemEl(t[2],n[2]);this.addCacheImageToItemEl(t[0],n[0])}}}},addCacheImageToItemEl:function(e,t){n.DOM.removeClass(t,r.Carousel.CssClasses.itemError);n.DOM.addClass(t,r.Carousel.CssClasses.itemLoading);n.DOM.removeChildren(t);n.DOM.setStyle(e.imageEl,{display:"none"});n.DOM.appendChild(e.imageEl,t);n.Animation.resetTranslate(e.imageEl);n.Events.add(e,r.Image.EventTypes.onLoad,this.imageLoadHandler);n.Events.add(e,r.Image.EventTypes.onError,this.imageErrorHandler);e.load()},slideCarousel:function(t,i,s){if(this.isSliding){return}var o,u,a;if(this.settings.target===e){o=n.DOM.windowWidth()+this.settings.margin}else{o=n.DOM.width(this.settings.target)+this.settings.margin}s=n.coalesce(s,this.settings.slideSpeed);if(e.Math.abs(u)<1){return}switch(i){case n.TouchElement.ActionTypes.swipeLeft:a=o*-1;break;case n.TouchElement.ActionTypes.swipeRight:a=o;break;default:u=t.x-this.touchStartPoint.x;if(e.Math.abs(u)>o/2){a=u>0?o:o*-1}else{a=0}break}if(a<0){this.lastSlideByAction=r.Carousel.SlideByAction.next}else if(a>0){this.lastSlideByAction=r.Carousel.SlideByAction.previous}else{this.lastSlideByAction=r.Carousel.SlideByAction.current}if(!this.settings.loop){if(this.lastSlideByAction===r.Carousel.SlideByAction.previous&&this.currentCacheIndex===0||this.lastSlideByAction===r.Carousel.SlideByAction.next&&this.currentCacheIndex===this.cache.images.length-1){a=0;this.lastSlideByAction=r.Carousel.SlideByAction.current}}this.isSliding=true;this.doSlideCarousel(a,s)},moveCarousel:function(e){if(this.isSliding){return}if(!this.settings.enableDrag){return}this.doMoveCarousel(e.x-this.touchStartPoint.x)},getItemEls:function(){return n.DOM.find("."+r.Carousel.CssClasses.item,this.contentEl)},previous:function(){this.stopSlideshow();this.slideCarousel({x:0,y:0},n.TouchElement.ActionTypes.swipeRight,this.settings.nextPreviousSlideSpeed)},next:function(){this.stopSlideshow();this.slideCarousel({x:0,y:0},n.TouchElement.ActionTypes.swipeLeft,this.settings.nextPreviousSlideSpeed)},slideshowNext:function(){this.slideCarousel({x:0,y:0},n.TouchElement.ActionTypes.swipeLeft)},startSlideshow:function(){this.stopSlideshow();this.isSlideshowActive=true;this.slideshowTimeout=e.setTimeout(this.slideshowNext.bind(this),this.settings.slideshowDelay);n.Events.fire(this,{type:r.Carousel.EventTypes.onSlideshowStart,target:this})},stopSlideshow:function(){if(!n.isNothing(this.slideshowTimeout)){e.clearTimeout(this.slideshowTimeout);this.slideshowTimeout=null;this.isSlideshowActive=false;n.Events.fire(this,{type:r.Carousel.EventTypes.onSlideshowStop,target:this})}},onSlideByEnd:function(e){if(n.isNothing(this.isSliding)){return}var t=this.getItemEls();this.isSliding=false;if(this.lastSlideByAction===r.Carousel.SlideByAction.next){this.currentCacheIndex=this.currentCacheIndex+1}else if(this.lastSlideByAction===r.Carousel.SlideByAction.previous){this.currentCacheIndex=this.currentCacheIndex-1}if(this.settings.loop){if(this.lastSlideByAction===r.Carousel.SlideByAction.next){n.DOM.appendChild(t[0],this.contentEl)}else if(this.lastSlideByAction===r.Carousel.SlideByAction.previous){n.DOM.insertBefore(t[t.length-1],t[0],this.contentEl)}if(this.currentCacheIndex<0){this.currentCacheIndex=this.cache.images.length-1}else if(this.currentCacheIndex===this.cache.images.length){this.currentCacheIndex=0}}else{if(this.cache.images.length>3){if(this.currentCacheIndex>1&&this.currentCacheIndex<this.cache.images.length-2){if(this.lastSlideByAction===r.Carousel.SlideByAction.next){n.DOM.appendChild(t[0],this.contentEl)}else if(this.lastSlideByAction===r.Carousel.SlideByAction.previous){n.DOM.insertBefore(t[t.length-1],t[0],this.contentEl)}}else if(this.currentCacheIndex===1){if(this.lastSlideByAction===r.Carousel.SlideByAction.previous){n.DOM.insertBefore(t[t.length-1],t[0],this.contentEl)}}else if(this.currentCacheIndex===this.cache.images.length-2){if(this.lastSlideByAction===r.Carousel.SlideByAction.next){n.DOM.appendChild(t[0],this.contentEl)}}}}if(this.lastSlideByAction!==r.Carousel.SlideByAction.current){this.setContentLeftPosition();this.setImages(true)}n.Events.fire(this,{type:r.Carousel.EventTypes.onSlideByEnd,target:this,action:this.lastSlideByAction,cacheIndex:this.currentCacheIndex});if(this.isSlideshowActive){if(this.lastSlideByAction!==r.Carousel.SlideByAction.current){this.startSlideshow()}else{this.stopSlideshow()}}},onTouch:function(t,r){this.stopSlideshow();switch(t){case n.TouchElement.ActionTypes.touchStart:this.touchStartPoint=r;this.touchStartPosition={x:e.parseInt(n.DOM.getStyle(this.contentEl,"left"),0),y:e.parseInt(n.DOM.getStyle(this.contentEl,"top"),0)};break;case n.TouchElement.ActionTypes.touchMove:this.moveCarousel(r);break;case n.TouchElement.ActionTypes.touchMoveEnd:case n.TouchElement.ActionTypes.swipeLeft:case n.TouchElement.ActionTypes.swipeRight:this.slideCarousel(r,t);break;case n.TouchElement.ActionTypes.tap:break;case n.TouchElement.ActionTypes.doubleTap:break}},onImageLoad:function(e){var t=e.target;if(!n.isNothing(t.imageEl.parentNode)){n.DOM.removeClass(t.imageEl.parentNode,r.Carousel.CssClasses.itemLoading);this.resetImagePosition(t.imageEl)}n.Events.remove(t,r.Image.EventTypes.onLoad,this.imageLoadHandler);n.Events.remove(t,r.Image.EventTypes.onError,this.imageErrorHandler)},onImageError:function(e){var t=e.target;if(!n.isNothing(t.imageEl.parentNode)){n.DOM.removeClass(t.imageEl.parentNode,r.Carousel.CssClasses.itemLoading);n.DOM.addClass(t.imageEl.parentNode,r.Carousel.CssClasses.itemError)}n.Events.remove(t,r.Image.EventTypes.onLoad,this.imageLoadHandler);n.Events.remove(t,r.Image.EventTypes.onError,this.imageErrorHandler)}})})(window,window.klass,window.Code.Util);(function(e,t,n,r){n.registerNamespace("Code.PhotoSwipe.Carousel");var i=e.Code.PhotoSwipe;i.Carousel.CarouselClass=i.Carousel.CarouselClass.extend({getStartingPos:function(){var t=this.touchStartPosition;if(n.isNothing(t)){t={x:e.parseInt(n.DOM.getStyle(this.contentEl,"left"),0),y:e.parseInt(n.DOM.getStyle(this.contentEl,"top"),0)}}return t},doMoveCarousel:function(t){var r;if(n.Browser.isCSSTransformSupported){r={};r[n.Animation._transitionPrefix+"Property"]="all";r[n.Animation._transitionPrefix+"Duration"]="";r[n.Animation._transitionPrefix+"TimingFunction"]="";r[n.Animation._transitionPrefix+"Delay"]="0";r[n.Animation._transformLabel]=n.Browser.is3dSupported?"translate3d("+t+"px, 0px, 0px)":"translate("+t+"px, 0px)";n.DOM.setStyle(this.contentEl,r)}else if(!n.isNothing(e.jQuery)){e.jQuery(this.contentEl).stop().css("left",this.getStartingPos().x+t+"px")}},doSlideCarousel:function(t,r){var i,s;if(r<=0){this.slideByEndHandler();return}if(n.Browser.isCSSTransformSupported){s=n.coalesce(this.contentEl.style.webkitTransform,this.contentEl.style.MozTransform,this.contentEl.style.transform,"");if(s.indexOf("translate3d("+t)===0){this.slideByEndHandler();return}else if(s.indexOf("translate("+t)===0){this.slideByEndHandler();return}n.Animation.slideBy(this.contentEl,t,0,r,this.slideByEndHandler,this.settings.slideTimingFunction)}else if(!n.isNothing(e.jQuery)){i={left:this.getStartingPos().x+t+"px"};if(this.settings.animationTimingFunction==="ease-out"){this.settings.animationTimingFunction="easeOutQuad"}if(n.isNothing(e.jQuery.easing[this.settings.animationTimingFunction])){this.settings.animationTimingFunction="linear"}e.jQuery(this.contentEl).animate(i,this.settings.slideSpeed,this.settings.animationTimingFunction,this.slideByEndHandler)}}})})(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.TouchElement);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Toolbar");var r=e.Code.PhotoSwipe;r.Toolbar.CssClasses={toolbar:"ps-toolbar",toolbarContent:"ps-toolbar-content",toolbarTop:"ps-toolbar-top",caption:"ps-caption",captionBottom:"ps-caption-bottom",captionContent:"ps-caption-content",close:"ps-toolbar-close",play:"ps-toolbar-play",previous:"ps-toolbar-previous",previousDisabled:"ps-toolbar-previous-disabled",next:"ps-toolbar-next",nextDisabled:"ps-toolbar-next-disabled"};r.Toolbar.ToolbarAction={close:"close",play:"play",next:"next",previous:"previous",none:"none"};r.Toolbar.EventTypes={onTap:"PhotoSwipeToolbarOnClick",onBeforeShow:"PhotoSwipeToolbarOnBeforeShow",onShow:"PhotoSwipeToolbarOnShow",onBeforeHide:"PhotoSwipeToolbarOnBeforeHide",onHide:"PhotoSwipeToolbarOnHide"};r.Toolbar.getToolbar=function(){return'<div class="'+r.Toolbar.CssClasses.close+'"><div class="'+r.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+r.Toolbar.CssClasses.play+'"><div class="'+r.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+r.Toolbar.CssClasses.previous+'"><div class="'+r.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+r.Toolbar.CssClasses.next+'"><div class="'+r.Toolbar.CssClasses.toolbarContent+'"></div></div>'}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Toolbar");var r=e.Code.PhotoSwipe;r.Toolbar.ToolbarClass=t({toolbarEl:null,closeEl:null,playEl:null,previousEl:null,nextEl:null,captionEl:null,captionContentEl:null,currentCaption:null,settings:null,cache:null,timeout:null,isVisible:null,fadeOutHandler:null,touchStartHandler:null,touchMoveHandler:null,clickHandler:null,dispose:function(){var e;this.clearTimeout();this.removeEventHandlers();n.Animation.stop(this.toolbarEl);n.Animation.stop(this.captionEl);n.DOM.removeChild(this.toolbarEl,this.toolbarEl.parentNode);n.DOM.removeChild(this.captionEl,this.captionEl.parentNode);for(e in this){if(n.objectHasProperty(this,e)){this[e]=null}}},initialize:function(t,i){var s;this.settings=i;this.cache=t;this.isVisible=false;this.fadeOutHandler=this.onFadeOut.bind(this);this.touchStartHandler=this.onTouchStart.bind(this);this.touchMoveHandler=this.onTouchMove.bind(this);this.clickHandler=this.onClick.bind(this);s=r.Toolbar.CssClasses.toolbar;if(this.settings.captionAndToolbarFlipPosition){s=s+" "+r.Toolbar.CssClasses.toolbarTop}this.toolbarEl=n.DOM.createElement("div",{"class":s},this.settings.getToolbar());n.DOM.setStyle(this.toolbarEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex});if(this.settings.target===e){n.DOM.appendToBody(this.toolbarEl)}else{n.DOM.appendChild(this.toolbarEl,this.settings.target)}n.DOM.hide(this.toolbarEl);this.closeEl=n.DOM.find("."+r.Toolbar.CssClasses.close,this.toolbarEl)[0];if(this.settings.preventHide&&!n.isNothing(this.closeEl)){n.DOM.hide(this.closeEl)}this.playEl=n.DOM.find("."+r.Toolbar.CssClasses.play,this.toolbarEl)[0];if(this.settings.preventSlideshow&&!n.isNothing(this.playEl)){n.DOM.hide(this.playEl)}this.nextEl=n.DOM.find("."+r.Toolbar.CssClasses.next,this.toolbarEl)[0];this.previousEl=n.DOM.find("."+r.Toolbar.CssClasses.previous,this.toolbarEl)[0];s=r.Toolbar.CssClasses.caption;if(this.settings.captionAndToolbarFlipPosition){s=s+" "+r.Toolbar.CssClasses.captionBottom}this.captionEl=n.DOM.createElement("div",{"class":s},"");n.DOM.setStyle(this.captionEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex});if(this.settings.target===e){n.DOM.appendToBody(this.captionEl)}else{n.DOM.appendChild(this.captionEl,this.settings.target)}n.DOM.hide(this.captionEl);this.captionContentEl=n.DOM.createElement("div",{"class":r.Toolbar.CssClasses.captionContent},"");n.DOM.appendChild(this.captionContentEl,this.captionEl);this.addEventHandlers()},resetPosition:function(){var t,r,i;if(this.settings.target===e){if(this.settings.captionAndToolbarFlipPosition){r=n.DOM.windowScrollTop();i=n.DOM.windowScrollTop()+n.DOM.windowHeight()-n.DOM.height(this.captionEl)}else{r=n.DOM.windowScrollTop()+n.DOM.windowHeight()-n.DOM.height(this.toolbarEl);i=n.DOM.windowScrollTop()}t=n.DOM.windowWidth()}else{if(this.settings.captionAndToolbarFlipPosition){r="0";i=n.DOM.height(this.settings.target)-n.DOM.height(this.captionEl)}else{r=n.DOM.height(this.settings.target)-n.DOM.height(this.toolbarEl);i=0}t=n.DOM.width(this.settings.target)}n.DOM.setStyle(this.toolbarEl,{top:r+"px",width:t});n.DOM.setStyle(this.captionEl,{top:i+"px",width:t})},toggleVisibility:function(e){if(this.isVisible){this.fadeOut()}else{this.show(e)}},show:function(e){n.Animation.stop(this.toolbarEl);n.Animation.stop(this.captionEl);this.resetPosition();this.setToolbarStatus(e);n.Events.fire(this,{type:r.Toolbar.EventTypes.onBeforeShow,target:this});this.showToolbar();this.setCaption(e);this.showCaption();this.isVisible=true;this.setTimeout();n.Events.fire(this,{type:r.Toolbar.EventTypes.onShow,target:this})},setTimeout:function(){if(this.settings.captionAndToolbarAutoHideDelay>0){this.clearTimeout();this.timeout=e.setTimeout(this.fadeOut.bind(this),this.settings.captionAndToolbarAutoHideDelay)}},clearTimeout:function(){if(!n.isNothing(this.timeout)){e.clearTimeout(this.timeout);this.timeout=null}},fadeOut:function(){this.clearTimeout();n.Events.fire(this,{type:r.Toolbar.EventTypes.onBeforeHide,target:this});n.Animation.fadeOut(this.toolbarEl,this.settings.fadeOutSpeed);n.Animation.fadeOut(this.captionEl,this.settings.fadeOutSpeed,this.fadeOutHandler);this.isVisible=false},addEventHandlers:function(){if(n.Browser.isTouchSupported){if(!n.Browser.blackberry){n.Events.add(this.toolbarEl,"touchstart",this.touchStartHandler)}n.Events.add(this.toolbarEl,"touchmove",this.touchMoveHandler);n.Events.add(this.captionEl,"touchmove",this.touchMoveHandler)}n.Events.add(this.toolbarEl,"click",this.clickHandler)},removeEventHandlers:function(){if(n.Browser.isTouchSupported){if(!n.Browser.blackberry){n.Events.remove(this.toolbarEl,"touchstart",this.touchStartHandler)}n.Events.remove(this.toolbarEl,"touchmove",this.touchMoveHandler);n.Events.remove(this.captionEl,"touchmove",this.touchMoveHandler)}n.Events.remove(this.toolbarEl,"click",this.clickHandler)},handleTap:function(e){this.clearTimeout();var t;if(e.target===this.nextEl||n.DOM.isChildOf(e.target,this.nextEl)){t=r.Toolbar.ToolbarAction.next}else if(e.target===this.previousEl||n.DOM.isChildOf(e.target,this.previousEl)){t=r.Toolbar.ToolbarAction.previous}else if(e.target===this.closeEl||n.DOM.isChildOf(e.target,this.closeEl)){t=r.Toolbar.ToolbarAction.close}else if(e.target===this.playEl||n.DOM.isChildOf(e.target,this.playEl)){t=r.Toolbar.ToolbarAction.play}this.setTimeout();if(n.isNothing(t)){t=r.Toolbar.ToolbarAction.none}n.Events.fire(this,{type:r.Toolbar.EventTypes.onTap,target:this,action:t,tapTarget:e.target})},setCaption:function(e){n.DOM.removeChildren(this.captionContentEl);this.currentCaption=n.coalesce(this.cache.images[e].caption," ");if(n.isObject(this.currentCaption)){n.DOM.appendChild(this.currentCaption,this.captionContentEl)}else{if(this.currentCaption===""){this.currentCaption=" "}n.DOM.appendText(this.currentCaption,this.captionContentEl)}this.currentCaption=this.currentCaption===" "?"":this.currentCaption;this.resetPosition()},showToolbar:function(){n.DOM.setStyle(this.toolbarEl,{opacity:this.settings.captionAndToolbarOpacity});n.DOM.show(this.toolbarEl)},showCaption:function(){if(this.currentCaption===""||this.captionContentEl.childNodes.length<1){if(!this.settings.captionAndToolbarShowEmptyCaptions){n.DOM.hide(this.captionEl);return}}n.DOM.setStyle(this.captionEl,{opacity:this.settings.captionAndToolbarOpacity});n.DOM.show(this.captionEl)},setToolbarStatus:function(e){if(this.settings.loop){return}n.DOM.removeClass(this.previousEl,r.Toolbar.CssClasses.previousDisabled);n.DOM.removeClass(this.nextEl,r.Toolbar.CssClasses.nextDisabled);if(e>0&&e<this.cache.images.length-1){return}if(e===0){if(!n.isNothing(this.previousEl)){n.DOM.addClass(this.previousEl,r.Toolbar.CssClasses.previousDisabled)}}if(e===this.cache.images.length-1){if(!n.isNothing(this.nextEl)){n.DOM.addClass(this.nextEl,r.Toolbar.CssClasses.nextDisabled)}}},onFadeOut:function(){n.DOM.hide(this.toolbarEl);n.DOM.hide(this.captionEl);n.Events.fire(this,{type:r.Toolbar.EventTypes.onHide,target:this})},onTouchStart:function(e){e.preventDefault();n.Events.remove(this.toolbarEl,"click",this.clickHandler);this.handleTap(e)},onTouchMove:function(e){e.preventDefault()},onClick:function(e){e.preventDefault();this.handleTap(e)}})})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.UILayer");var r=e.Code.PhotoSwipe;r.UILayer.CssClasses={uiLayer:"ps-uilayer"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.UILayer");var r=e.Code.PhotoSwipe;r.UILayer.UILayerClass=n.TouchElement.TouchElementClass.extend({el:null,settings:null,dispose:function(){var e;this.removeEventHandlers();n.DOM.removeChild(this.el,this.el.parentNode);for(e in this){if(n.objectHasProperty(this,e)){this[e]=null}}},initialize:function(t){this.settings=t;this.el=n.DOM.createElement("div",{"class":r.UILayer.CssClasses.uiLayer},"");n.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex,opacity:0});n.DOM.hide(this.el);if(this.settings.target===e){n.DOM.appendToBody(this.el)}else{n.DOM.appendChild(this.el,this.settings.target)}this.supr(this.el,{swipe:true,move:true,gesture:n.Browser.iOS,doubleTap:true,preventDefaultTouchEvents:this.settings.preventDefaultTouchEvents})},resetPosition:function(){if(this.settings.target===e){n.DOM.setStyle(this.el,{top:n.DOM.windowScrollTop()+"px",width:n.DOM.windowWidth(),height:n.DOM.windowHeight()})}else{n.DOM.setStyle(this.el,{top:"0px",width:n.DOM.width(this.settings.target),height:n.DOM.height(this.settings.target)})}},show:function(){this.resetPosition();n.DOM.show(this.el);this.addEventHandlers()},addEventHandlers:function(){this.supr()},removeEventHandlers:function(){this.supr()}})})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var r=e.Code.PhotoSwipe;r.ZoomPanRotate.CssClasses={zoomPanRotate:"ps-zoom-pan-rotate"};r.ZoomPanRotate.EventTypes={onTransform:"PhotoSwipeZoomPanRotateOnTransform"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var r=e.Code.PhotoSwipe;r.ZoomPanRotate.ZoomPanRotateClass=t({el:null,settings:null,containerEl:null,imageEl:null,transformSettings:null,panStartingPoint:null,transformEl:null,dispose:function(){var e;n.DOM.removeChild(this.el,this.el.parentNode);for(e in this){if(n.objectHasProperty(this,e)){this[e]=null}}},initialize:function(t,i,s){var o,u,a,f;this.settings=t;if(this.settings.target===e){o=document.body;u=n.DOM.windowWidth();a=n.DOM.windowHeight();f=n.DOM.windowScrollTop()+"px"}else{o=this.settings.target;u=n.DOM.width(o);a=n.DOM.height(o);f="0px"}this.imageEl=i.imageEl.cloneNode(false);n.DOM.setStyle(this.imageEl,{zIndex:1});this.transformSettings={startingScale:1,scale:1,startingRotation:0,rotation:0,startingTranslateX:0,startingTranslateY:0,translateX:0,translateY:0};this.el=n.DOM.createElement("div",{"class":r.ZoomPanRotate.CssClasses.zoomPanRotate},"");n.DOM.setStyle(this.el,{left:0,top:f,position:"absolute",width:u,height:a,zIndex:this.settings.zIndex,display:"block"});n.DOM.insertBefore(this.el,s.el,o);if(n.Browser.iOS){this.containerEl=n.DOM.createElement("div","","");n.DOM.setStyle(this.containerEl,{left:0,top:0,width:u,height:a,position:"absolute",zIndex:1});n.DOM.appendChild(this.imageEl,this.containerEl);n.DOM.appendChild(this.containerEl,this.el);n.Animation.resetTranslate(this.containerEl);n.Animation.resetTranslate(this.imageEl);this.transformEl=this.containerEl}else{n.DOM.appendChild(this.imageEl,this.el);this.transformEl=this.imageEl}},setStartingTranslateFromCurrentTransform:function(){var t=n.coalesce(this.transformEl.style.webkitTransform,this.transformEl.style.MozTransform,this.transformEl.style.transform),r;if(!n.isNothing(t)){r=t.match(/translate\((.*?)\)/);if(!n.isNothing(r)){r=r[1].split(", ");this.transformSettings.startingTranslateX=e.parseInt(r[0],10);this.transformSettings.startingTranslateY=e.parseInt(r[1],10)}}},getScale:function(e){var t=this.transformSettings.startingScale*e;if(this.settings.minUserZoom!==0&&t<this.settings.minUserZoom){t=this.settings.minUserZoom}else if(this.settings.maxUserZoom!==0&&t>this.settings.maxUserZoom){t=this.settings.maxUserZoom}return t},setStartingScaleAndRotation:function(e,t){this.transformSettings.startingScale=this.getScale(e);this.transformSettings.startingRotation=(this.transformSettings.startingRotation+t)%360},zoomRotate:function(e,t){this.transformSettings.scale=this.getScale(e);this.transformSettings.rotation=this.transformSettings.startingRotation+t;this.applyTransform()},panStart:function(e){this.setStartingTranslateFromCurrentTransform();this.panStartingPoint={x:e.x,y:e.y}},pan:function(e){var t=e.x-this.panStartingPoint.x,n=e.y-this.panStartingPoint.y,r=t/this.transformSettings.scale,i=n/this.transformSettings.scale;this.transformSettings.translateX=this.transformSettings.startingTranslateX+r;this.transformSettings.translateY=this.transformSettings.startingTranslateY+i;this.applyTransform()},zoomAndPanToPoint:function(t,r){if(this.settings.target===e){this.panStart({x:n.DOM.windowWidth()/2,y:n.DOM.windowHeight()/2});var i=r.x-this.panStartingPoint.x,s=r.y-this.panStartingPoint.y,o=i/this.transformSettings.scale,u=s/this.transformSettings.scale;this.transformSettings.translateX=(this.transformSettings.startingTranslateX+o)*-1;this.transformSettings.translateY=(this.transformSettings.startingTranslateY+u)*-1}this.setStartingScaleAndRotation(t,0);this.transformSettings.scale=this.transformSettings.startingScale;this.transformSettings.rotation=0;this.applyTransform()},applyTransform:function(){var t=this.transformSettings.rotation%360,i=e.parseInt(this.transformSettings.translateX,10),s=e.parseInt(this.transformSettings.translateY,10),o="scale("+this.transformSettings.scale+") rotate("+t+"deg) translate("+i+"px, "+s+"px)";n.DOM.setStyle(this.transformEl,{webkitTransform:o,MozTransform:o,msTransform:o,transform:o});n.Events.fire(this,{target:this,type:r.ZoomPanRotate.EventTypes.onTransform,scale:this.transformSettings.scale,rotation:this.transformSettings.rotation,rotationDegs:t,translateX:i,translateY:s})}})})(window,window.klass,window.Code.Util);(function(e,t){t.registerNamespace("Code.PhotoSwipe");var n=e.Code.PhotoSwipe;n.CssClasses={buildingBody:"ps-building",activeBody:"ps-active"};n.EventTypes={onBeforeShow:"PhotoSwipeOnBeforeShow",onShow:"PhotoSwipeOnShow",onBeforeHide:"PhotoSwipeOnBeforeHide",onHide:"PhotoSwipeOnHide",onDisplayImage:"PhotoSwipeOnDisplayImage",onResetPosition:"PhotoSwipeOnResetPosition",onSlideshowStart:"PhotoSwipeOnSlideshowStart",onSlideshowStop:"PhotoSwipeOnSlideshowStop",onTouch:"PhotoSwipeOnTouch",onBeforeCaptionAndToolbarShow:"PhotoSwipeOnBeforeCaptionAndToolbarShow",onCaptionAndToolbarShow:"PhotoSwipeOnCaptionAndToolbarShow",onBeforeCaptionAndToolbarHide:"PhotoSwipeOnBeforeCaptionAndToolbarHide",onCaptionAndToolbarHide:"PhotoSwipeOnCaptionAndToolbarHide",onToolbarTap:"PhotoSwipeOnToolbarTap",onBeforeZoomPanRotateShow:"PhotoSwipeOnBeforeZoomPanRotateShow",onZoomPanRotateShow:"PhotoSwipeOnZoomPanRotateShow",onBeforeZoomPanRotateHide:"PhotoSwipeOnBeforeZoomPanRotateHide",onZoomPanRotateHide:"PhotoSwipeOnZoomPanRotateHide",onZoomPanRotateTransform:"PhotoSwipeOnZoomPanRotateTransform"};n.instances=[];n.activeInstances=[];n.setActivateInstance=function(e){var r=t.arrayIndexOf(e.settings.target,n.activeInstances,"target");if(r>-1){throw"Code.PhotoSwipe.activateInstance: Unable to active instance as another instance is already active for this target"}n.activeInstances.push({target:e.settings.target,instance:e})};n.unsetActivateInstance=function(e){var r=t.arrayIndexOf(e,n.activeInstances,"instance");n.activeInstances.splice(r,1)};n.attach=function(e,r,i){var s,o,u,a;u=n.createInstance(e,r,i);for(s=0,o=e.length;s<o;s++){a=e[s];if(!t.isNothing(a.nodeType)){if(a.nodeType===1){a.__photoSwipeClickHandler=n.onTriggerElementClick.bind(u);t.Events.remove(a,"click",a.__photoSwipeClickHandler);t.Events.add(a,"click",a.__photoSwipeClickHandler)}}}return u};if(e.jQuery){e.jQuery.fn.photoSwipe=function(e,t){return n.attach(this,e,t)}}n.detatch=function(e){var r,i,s;for(r=0,i=e.originalImages.length;r<i;r++){s=e.originalImages[r];if(!t.isNothing(s.nodeType)){if(s.nodeType===1){t.Events.remove(s,"click",s.__photoSwipeClickHandler);delete s.__photoSwipeClickHandler}}}n.disposeInstance(e)};n.createInstance=function(e,r,i){var s,o,u;if(t.isNothing(e)){throw"Code.PhotoSwipe.attach: No images passed."}if(!t.isLikeArray(e)){throw"Code.PhotoSwipe.createInstance: Images must be an array of elements or image urls."}if(e.length<1){throw"Code.PhotoSwipe.createInstance: No images to passed."}r=t.coalesce(r,{});o=n.getInstance(i);if(t.isNothing(o)){o=new n.PhotoSwipeClass(e,r,i);n.instances.push(o)}else{throw'Code.PhotoSwipe.createInstance: Instance with id "'+i+' already exists."'}return o};n.disposeInstance=function(e){var t=n.getInstanceIndex(e);if(t<0){throw"Code.PhotoSwipe.disposeInstance: Unable to find instance to dispose."}e.dispose();n.instances.splice(t,1);e=null};n.onTriggerElementClick=function(e){e.preventDefault();var t=this;t.show(e.currentTarget)};n.getInstance=function(e){var t,r,i;for(t=0,r=n.instances.length;t<r;t++){i=n.instances[t];if(i.id===e){return i}}return null};n.getInstanceIndex=function(e){var t,r,i=-1;for(t=0,r=n.instances.length;t<r;t++){if(n.instances[t]===e){i=t;break}}return i}})(window,window.Code.Util);(function(e,t,n,r,i,s,o,u,a){n.registerNamespace("Code.PhotoSwipe");var f=e.Code.PhotoSwipe;f.PhotoSwipeClass=t({id:null,settings:null,isBackEventSupported:null,backButtonClicked:null,currentIndex:null,originalImages:null,mouseWheelStartTime:null,windowDimensions:null,cache:null,documentOverlay:null,carousel:null,uiLayer:null,toolbar:null,zoomPanRotate:null,windowOrientationChangeHandler:null,windowScrollHandler:null,windowHashChangeHandler:null,keyDownHandler:null,windowOrientationEventName:null,uiLayerTouchHandler:null,carouselSlideByEndHandler:null,carouselSlideshowStartHandler:null,carouselSlideshowStopHandler:null,toolbarTapHandler:null,toolbarBeforeShowHandler:null,toolbarShowHandler:null,toolbarBeforeHideHandler:null,toolbarHideHandler:null,mouseWheelHandler:null,zoomPanRotateTransformHandler:null,_isResettingPosition:null,_uiWebViewResetPositionTimeout:null,dispose:function(){var e;n.Events.remove(this,f.EventTypes.onBeforeShow);n.Events.remove(this,f.EventTypes.onShow);n.Events.remove(this,f.EventTypes.onBeforeHide);n.Events.remove(this,f.EventTypes.onHide);n.Events.remove(this,f.EventTypes.onDisplayImage);n.Events.remove(this,f.EventTypes.onResetPosition);n.Events.remove(this,f.EventTypes.onSlideshowStart);n.Events.remove(this,f.EventTypes.onSlideshowStop);n.Events.remove(this,f.EventTypes.onTouch);n.Events.remove(this,f.EventTypes.onBeforeCaptionAndToolbarShow);n.Events.remove(this,f.EventTypes.onCaptionAndToolbarShow);n.Events.remove(this,f.EventTypes.onBeforeCaptionAndToolbarHide);n.Events.remove(this,f.EventTypes.onCaptionAndToolbarHide);n.Events.remove(this,f.EventTypes.onZoomPanRotateTransform);this.removeEventHandlers();if(!n.isNothing(this.documentOverlay)){this.documentOverlay.dispose()}if(!n.isNothing(this.carousel)){this.carousel.dispose()}if(!n.isNothing(this.uiLayer)){this.uiLayer.dispose()}if(!n.isNothing(this.toolbar)){this.toolbar.dispose()}this.destroyZoomPanRotate();if(!n.isNothing(this.cache)){this.cache.dispose()}for(e in this){if(n.objectHasProperty(this,e)){this[e]=null}}},initialize:function(t,i,s){var o;if(n.isNothing(s)){this.id="PhotoSwipe"+(new Date).getTime().toString()}else{this.id=s}this.originalImages=t;if(n.Browser.android&&!n.Browser.firefox){if(e.navigator.userAgent.match(/Android (\d+.\d+)/).toString().replace(/^.*\,/,"")>=2.1){this.isBackEventSupported=true}}if(!this.isBackEventSupported){this.isBackEventSupported=n.objectHasProperty(e,"onhashchange")}this.settings={fadeInSpeed:250,fadeOutSpeed:250,preventHide:false,preventSlideshow:false,zIndex:1e3,backButtonHideEnabled:true,enableKeyboard:true,enableMouseWheel:true,mouseWheelSpeed:350,autoStartSlideshow:false,jQueryMobile:!n.isNothing(e.jQuery)&&!n.isNothing(e.jQuery.mobile),jQueryMobileDialogHash:"&ui-state=dialog",enableUIWebViewRepositionTimeout:false,uiWebViewResetPositionDelay:500,target:e,preventDefaultTouchEvents:true,loop:true,slideSpeed:250,nextPreviousSlideSpeed:0,enableDrag:true,swipeThreshold:50,swipeTimeThreshold:250,slideTimingFunction:"ease-out",slideshowDelay:3e3,doubleTapSpeed:250,margin:20,imageScaleMethod:"fit",captionAndToolbarHide:false,captionAndToolbarFlipPosition:false,captionAndToolbarAutoHideDelay:5e3,captionAndToolbarOpacity:.8,captionAndToolbarShowEmptyCaptions:true,getToolbar:f.Toolbar.getToolbar,allowUserZoom:true,allowRotationOnUserZoom:false,maxUserZoom:5,minUserZoom:.5,doubleTapZoomLevel:2.5,getImageSource:f.Cache.Functions.getImageSource,getImageCaption:f.Cache.Functions.getImageCaption,getImageMetaData:f.Cache.Functions.getImageMetaData,cacheMode:f.Cache.Mode.normal};n.extend(this.settings,i);if(this.settings.target!==e){o=n.DOM.getStyle(this.settings.target,"position");if(o!=="relative"||o!=="absolute"){n.DOM.setStyle(this.settings.target,"position","relative")}}if(this.settings.target!==e){this.isBackEventSupported=false;this.settings.backButtonHideEnabled=false}else{if(this.settings.preventHide){this.settings.backButtonHideEnabled=false}}this.cache=new r.CacheClass(t,this.settings)},show:function(t){var r,i;this._isResettingPosition=false;this.backButtonClicked=false;if(n.isNumber(t)){this.currentIndex=t}else{this.currentIndex=-1;for(r=0,i=this.originalImages.length;r<i;r++){if(this.originalImages[r]===t){this.currentIndex=r;break}}}if(this.currentIndex<0||this.currentIndex>this.originalImages.length-1){throw"Code.PhotoSwipe.PhotoSwipeClass.show: Starting index out of range"}this.isAlreadyGettingPage=this.getWindowDimensions();f.setActivateInstance(this);this.windowDimensions=this.getWindowDimensions();if(this.settings.target===e){n.DOM.addClass(e.document.body,f.CssClasses.buildingBody)}else{n.DOM.addClass(this.settings.target,f.CssClasses.buildingBody)}this.createComponents();n.Events.fire(this,{type:f.EventTypes.onBeforeShow,target:this});this.documentOverlay.fadeIn(this.settings.fadeInSpeed,this.onDocumentOverlayFadeIn.bind(this))},getWindowDimensions:function(){return{width:n.DOM.windowWidth(),height:n.DOM.windowHeight()}},createComponents:function(){this.documentOverlay=new i.DocumentOverlayClass(this.settings);this.carousel=new s.CarouselClass(this.cache,this.settings);this.uiLayer=new u.UILayerClass(this.settings);if(!this.settings.captionAndToolbarHide){this.toolbar=new o.ToolbarClass(this.cache,this.settings)}},resetPosition:function(){if(this._isResettingPosition){return}var e=this.getWindowDimensions();if(!n.isNothing(this.windowDimensions)){if(e.width===this.windowDimensions.width&&e.height===this.windowDimensions.height){return}}this._isResettingPosition=true;this.windowDimensions=e;this.destroyZoomPanRotate();this.documentOverlay.resetPosition();this.carousel.resetPosition();if(!n.isNothing(this.toolbar)){this.toolbar.resetPosition()}this.uiLayer.resetPosition();this._isResettingPosition=false;n.Events.fire(this,{type:f.EventTypes.onResetPosition,target:this})},addEventHandler:function(e,t){n.Events.add(this,e,t)},addEventHandlers:function(){if(n.isNothing(this.windowOrientationChangeHandler)){this.windowOrientationChangeHandler=this.onWindowOrientationChange.bind(this);this.windowScrollHandler=this.onWindowScroll.bind(this);this.keyDownHandler=this.onKeyDown.bind(this);this.windowHashChangeHandler=this.onWindowHashChange.bind(this);this.uiLayerTouchHandler=this.onUILayerTouch.bind(this);this.carouselSlideByEndHandler=this.onCarouselSlideByEnd.bind(this);this.carouselSlideshowStartHandler=this.onCarouselSlideshowStart.bind(this);this.carouselSlideshowStopHandler=this.onCarouselSlideshowStop.bind(this);this.toolbarTapHandler=this.onToolbarTap.bind(this);this.toolbarBeforeShowHandler=this.onToolbarBeforeShow.bind(this);this.toolbarShowHandler=this.onToolbarShow.bind(this);this.toolbarBeforeHideHandler=this.onToolbarBeforeHide.bind(this);this.toolbarHideHandler=this.onToolbarHide.bind(this);this.mouseWheelHandler=this.onMouseWheel.bind(this);this.zoomPanRotateTransformHandler=this.onZoomPanRotateTransform.bind(this)}if(n.Browser.android){this.orientationEventName="resize"}else if(n.Browser.iOS&&!n.Browser.safari){n.Events.add(e.document.body,"orientationchange",this.windowOrientationChangeHandler)}else{var t=!n.isNothing(e.onorientationchange);this.orientationEventName=t?"orientationchange":"resize"}if(!n.isNothing(this.orientationEventName)){n.Events.add(e,this.orientationEventName,this.windowOrientationChangeHandler)}if(this.settings.target===e){n.Events.add(e,"scroll",this.windowScrollHandler)}if(this.settings.enableKeyboard){n.Events.add(e.document,"keydown",this.keyDownHandler)}if(this.isBackEventSupported&&this.settings.backButtonHideEnabled){this.windowHashChangeHandler=this.onWindowHashChange.bind(this);if(this.settings.jQueryMobile){e.location.hash=this.settings.jQueryMobileDialogHash}else{this.currentHistoryHashValue="PhotoSwipe"+(new Date).getTime().toString();e.location.hash=this.currentHistoryHashValue}n.Events.add(e,"hashchange",this.windowHashChangeHandler)}if(this.settings.enableMouseWheel){n.Events.add(e,"mousewheel",this.mouseWheelHandler)}n.Events.add(this.uiLayer,n.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler);n.Events.add(this.carousel,s.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler);n.Events.add(this.carousel,s.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler);n.Events.add(this.carousel,s.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler);if(!n.isNothing(this.toolbar)){n.Events.add(this.toolbar,o.EventTypes.onTap,this.toolbarTapHandler);n.Events.add(this.toolbar,o.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler);n.Events.add(this.toolbar,o.EventTypes.onShow,this.toolbarShowHandler);n.Events.add(this.toolbar,o.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler);n.Events.add(this.toolbar,o.EventTypes.onHide,this.toolbarHideHandler)}},removeEventHandlers:function(){if(n.Browser.iOS&&!n.Browser.safari){n.Events.remove(e.document.body,"orientationchange",this.windowOrientationChangeHandler)}if(!n.isNothing(this.orientationEventName)){n.Events.remove(e,this.orientationEventName,this.windowOrientationChangeHandler)}n.Events.remove(e,"scroll",this.windowScrollHandler);if(this.settings.enableKeyboard){n.Events.remove(e.document,"keydown",this.keyDownHandler)}if(this.isBackEventSupported&&this.settings.backButtonHideEnabled){n.Events.remove(e,"hashchange",this.windowHashChangeHandler)}if(this.settings.enableMouseWheel){n.Events.remove(e,"mousewheel",this.mouseWheelHandler)}if(!n.isNothing(this.uiLayer)){n.Events.remove(this.uiLayer,n.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler)}if(!n.isNothing(this.toolbar)){n.Events.remove(this.carousel,s.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler);n.Events.remove(this.carousel,s.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler);n.Events.remove(this.carousel,s.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler)}if(!n.isNothing(this.toolbar)){n.Events.remove(this.toolbar,o.EventTypes.onTap,this.toolbarTapHandler);n.Events.remove(this.toolbar,o.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler);n.Events.remove(this.toolbar,o.EventTypes.onShow,this.toolbarShowHandler);n.Events.remove(this.toolbar,o.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler);n.Events.remove(this.toolbar,o.EventTypes.onHide,this.toolbarHideHandler)}},hide:function(){if(this.settings.preventHide){return}if(n.isNothing(this.documentOverlay)){throw"Code.PhotoSwipe.PhotoSwipeClass.hide: PhotoSwipe instance is already hidden"}if(!n.isNothing(this.hiding)){return}this.clearUIWebViewResetPositionTimeout();this.destroyZoomPanRotate();this.removeEventHandlers();n.Events.fire(this,{type:f.EventTypes.onBeforeHide,target:this});this.uiLayer.dispose();this.uiLayer=null;if(!n.isNothing(this.toolbar)){this.toolbar.dispose();this.toolbar=null}this.carousel.dispose();this.carousel=null;n.DOM.removeClass(e.document.body,f.CssClasses.activeBody);this.documentOverlay.dispose();this.documentOverlay=null;this._isResettingPosition=false;f.unsetActivateInstance(this);n.Events.fire(this,{type:f.EventTypes.onHide,target:this});this.goBackInHistory()},goBackInHistory:function(){if(this.isBackEventSupported&&this.settings.backButtonHideEnabled){if(!this.backButtonClicked){e.history.back()}}},play:function(){if(this.isZoomActive()){return}if(!this.settings.preventSlideshow){if(!n.isNothing(this.carousel)){if(!n.isNothing(this.toolbar)&&this.toolbar.isVisible){this.toolbar.fadeOut()}this.carousel.startSlideshow()}}},stop:function(){if(this.isZoomActive()){return}if(!n.isNothing(this.carousel)){this.carousel.stopSlideshow()}},previous:function(){if(this.isZoomActive()){return}if(!n.isNothing(this.carousel)){this.carousel.previous()}},next:function(){if(this.isZoomActive()){return}if(!n.isNothing(this.carousel)){this.carousel.next()}},toggleToolbar:function(){if(this.isZoomActive()){return}if(!n.isNothing(this.toolbar)){this.toolbar.toggleVisibility(this.currentIndex)}},fadeOutToolbarIfVisible:function(){if(!n.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.settings.captionAndToolbarAutoHideDelay>0){this.toolbar.fadeOut()}},createZoomPanRotate:function(){this.stop();if(this.canUserZoom()&&!this.isZoomActive()){n.Events.fire(this,f.EventTypes.onBeforeZoomPanRotateShow);this.zoomPanRotate=new a.ZoomPanRotateClass(this.settings,this.cache.images[this.currentIndex],this.uiLayer);this.uiLayer.captureSettings.preventDefaultTouchEvents=true;n.Events.add(this.zoomPanRotate,f.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler);n.Events.fire(this,f.EventTypes.onZoomPanRotateShow);if(!n.isNothing(this.toolbar)&&this.toolbar.isVisible){this.toolbar.fadeOut()}}},destroyZoomPanRotate:function(){if(!n.isNothing(this.zoomPanRotate)){n.Events.fire(this,f.EventTypes.onBeforeZoomPanRotateHide);n.Events.remove(this.zoomPanRotate,f.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler);this.zoomPanRotate.dispose();this.zoomPanRotate=null;this.uiLayer.captureSettings.preventDefaultTouchEvents=this.settings.preventDefaultTouchEvents;n.Events.fire(this,f.EventTypes.onZoomPanRotateHide)}},canUserZoom:function(){var e,t;if(n.Browser.msie){e=document.createElement("div");if(n.isNothing(e.style.msTransform)){return false}}else if(!n.Browser.isCSSTransformSupported){return false}if(!this.settings.allowUserZoom){return false}if(this.carousel.isSliding){return false}t=this.cache.images[this.currentIndex];if(n.isNothing(t)){return false}if(t.isLoading){return false}return true},isZoomActive:function(){return!n.isNothing(this.zoomPanRotate)},getCurrentImage:function(){return this.cache.images[this.currentIndex]},onDocumentOverlayFadeIn:function(t){e.setTimeout(function(){var t=this.settings.target===e?e.document.body:this.settings.target;n.DOM.removeClass(t,f.CssClasses.buildingBody);n.DOM.addClass(t,f.CssClasses.activeBody);this.addEventHandlers();this.carousel.show(this.currentIndex);this.uiLayer.show();if(this.settings.autoStartSlideshow){this.play()}else if(!n.isNothing(this.toolbar)){this.toolbar.show(this.currentIndex)}n.Events.fire(this,{type:f.EventTypes.onShow,target:this});this.setUIWebViewResetPositionTimeout()}.bind(this),250)},setUIWebViewResetPositionTimeout:function(){if(!this.settings.enableUIWebViewRepositionTimeout){return}if(!(n.Browser.iOS&&!n.Browser.safari)){return}if(!n.isNothing(this._uiWebViewResetPositionTimeout)){e.clearTimeout(this._uiWebViewResetPositionTimeout)}this._uiWebViewResetPositionTimeout=e.setTimeout(function(){this.resetPosition();this.setUIWebViewResetPositionTimeout()}.bind(this),this.settings.uiWebViewResetPositionDelay)},clearUIWebViewResetPositionTimeout:function(){if(!n.isNothing(this._uiWebViewResetPositionTimeout)){e.clearTimeout(this._uiWebViewResetPositionTimeout)}},onWindowScroll:function(e){this.resetPosition()},onWindowOrientationChange:function(e){this.resetPosition()},onWindowHashChange:function(t){var n="#"+(this.settings.jQueryMobile?this.settings.jQueryMobileDialogHash:this.currentHistoryHashValue);if(e.location.hash!==n){this.backButtonClicked=true;this.hide()}},onKeyDown:function(e){if(e.keyCode===37){e.preventDefault();this.previous()}else if(e.keyCode===39){e.preventDefault();this.next()}else if(e.keyCode===38||e.keyCode===40){e.preventDefault()}else if(e.keyCode===27){e.preventDefault();this.hide()}else if(e.keyCode===32){if(!this.settings.hideToolbar){this.toggleToolbar()}else{this.hide()}e.preventDefault()}else if(e.keyCode===13){e.preventDefault();this.play()}},onUILayerTouch:function(t){if(this.isZoomActive()){switch(t.action){case n.TouchElement.ActionTypes.gestureChange:this.zoomPanRotate.zoomRotate(t.scale,this.settings.allowRotationOnUserZoom?t.rotation:0);break;case n.TouchElement.ActionTypes.gestureEnd:this.zoomPanRotate.setStartingScaleAndRotation(t.scale,this.settings.allowRotationOnUserZoom?t.rotation:0);break;case n.TouchElement.ActionTypes.touchStart:this.zoomPanRotate.panStart(t.point);break;case n.TouchElement.ActionTypes.touchMove:this.zoomPanRotate.pan(t.point);break;case n.TouchElement.ActionTypes.doubleTap:this.destroyZoomPanRotate();this.toggleToolbar();break;case n.TouchElement.ActionTypes.swipeLeft:this.destroyZoomPanRotate();this.next();this.toggleToolbar();break;case n.TouchElement.ActionTypes.swipeRight:this.destroyZoomPanRotate();this.previous();this.toggleToolbar();break}}else{switch(t.action){case n.TouchElement.ActionTypes.touchMove:case n.TouchElement.ActionTypes.swipeLeft:case n.TouchElement.ActionTypes.swipeRight:this.fadeOutToolbarIfVisible();this.carousel.onTouch(t.action,t.point);break;case n.TouchElement.ActionTypes.touchStart:case n.TouchElement.ActionTypes.touchMoveEnd:this.carousel.onTouch(t.action,t.point);break;case n.TouchElement.ActionTypes.tap:this.toggleToolbar();break;case n.TouchElement.ActionTypes.doubleTap:if(this.settings.target===e){t.point.x-=n.DOM.windowScrollLeft();t.point.y-=n.DOM.windowScrollTop()}var r=this.cache.images[this.currentIndex].imageEl,i=e.parseInt(n.DOM.getStyle(r,"top"),10),s=e.parseInt(n.DOM.getStyle(r,"left"),10),o=s+n.DOM.width(r),u=i+n.DOM.height(r);if(t.point.x<s){t.point.x=s}else if(t.point.x>o){t.point.x=o}if(t.point.y<i){t.point.y=i}else if(t.point.y>u){t.point.y=u}this.createZoomPanRotate();if(this.isZoomActive()){this.zoomPanRotate.zoomAndPanToPoint(this.settings.doubleTapZoomLevel,t.point)}break;case n.TouchElement.ActionTypes.gestureStart:this.createZoomPanRotate();break}}n.Events.fire(this,{type:f.EventTypes.onTouch,target:this,point:t.point,action:t.action})},onCarouselSlideByEnd:function(e){this.currentIndex=e.cacheIndex;if(!n.isNothing(this.toolbar)){this.toolbar.setCaption(this.currentIndex);this.toolbar.setToolbarStatus(this.currentIndex)}n.Events.fire(this,{type:f.EventTypes.onDisplayImage,target:this,action:e.action,index:e.cacheIndex})},onToolbarTap:function(e){switch(e.action){case o.ToolbarAction.next:this.next();break;case o.ToolbarAction.previous:this.previous();break;case o.ToolbarAction.close:this.hide();break;case o.ToolbarAction.play:this.play();break}n.Events.fire(this,{type:f.EventTypes.onToolbarTap,target:this,toolbarAction:e.action,tapTarget:e.tapTarget})},onMouseWheel:function(e){var t=n.Events.getWheelDelta(e),r=e.timeStamp-(this.mouseWheelStartTime||0);if(r<this.settings.mouseWheelSpeed){return}this.mouseWheelStartTime=e.timeStamp;if(this.settings.invertMouseWheel){t=t*-1}if(t<0){this.next()}else if(t>0){this.previous()}},onCarouselSlideshowStart:function(e){n.Events.fire(this,{type:f.EventTypes.onSlideshowStart,target:this})},onCarouselSlideshowStop:function(e){n.Events.fire(this,{type:f.EventTypes.onSlideshowStop,target:this})},onToolbarBeforeShow:function(e){n.Events.fire(this,{type:f.EventTypes.onBeforeCaptionAndToolbarShow,target:this})},onToolbarShow:function(e){n.Events.fire(this,{type:f.EventTypes.onCaptionAndToolbarShow,target:this})},onToolbarBeforeHide:function(e){n.Events.fire(this,{type:f.EventTypes.onBeforeCaptionAndToolbarHide,target:this})},onToolbarHide:function(e){n.Events.fire(this,{type:f.EventTypes.onCaptionAndToolbarHide,target:this})},onZoomPanRotateTransform:function(e){n.Events.fire(this,{target:this,type:f.EventTypes.onZoomPanRotateTransform,scale:e.scale,rotation:e.rotation,rotationDegs:e.rotationDegs,translateX:e.translateX,translateY:e.translateY})}})})(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Cache,window.Code.PhotoSwipe.DocumentOverlay,window.Code.PhotoSwipe.Carousel,window.Code.PhotoSwipe.Toolbar,window.Code.PhotoSwipe.UILayer,window.Code.PhotoSwipe.ZoomPanRotate)